# Задача
Требуется сделать систему логирования действий с новостями. Новости — это элементы нового инфоблока. Нужно логировать каждое действие с новостями (добавление, изменение, удаление).

Раз в неделю (период отправки задаётся через изменение интервала работы агента) нужно отправлять письмо, с информацией:
1. Сколько всего было добавлено, отредактировано и удалено уникальных новостей за время, прошедшее с предыдущего письма. Например новость была добавлена и дважды отредактирована, итого у нас будет — добавлено: 1, отредактировано: 1. Если она после редактирования была удалена, то будет добавлено: 1, отредактировано: 1, удалено: 1.
2. ФИО пользователя, сделавшего наибольшее количество действий с новостями за тот же период. Нужно считать уникальные действия на новость. Если пользователь создал и трижды отредактировал новость, то это будет 2 действия: создание и редактирование.

Получается, учитываться должны действия, совершённые после отправки предыдущего письма агентом.

# Решение
Разработал модуль afonya.lognews

При установке создается ORM-таблица "afonya_lognews_entity_log", в которой будут хранится лог изменений.

Регистрируются 3 события для элемента ИБ (Add, Update и Delete).

Создаются почтовые событие и шаблон для отправки письма.

Создается агент.

При удалении модуля, все это удаляется.

После установки модуля нужно перейти на страницу настроек и выбрать нужны ИБ (выпадающий список).
И с этого момента начнет копится статистика по нему.

Метод-агент запрашивает все данные (в момент запуска), шлет письмо и очищает таблицу.